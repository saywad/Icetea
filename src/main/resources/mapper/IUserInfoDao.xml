<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.Icetea.dao.IUserInfoDao">

    <resultMap id="UserInfoMap" type="com.example.Icetea.dto.UserInfoDto">
        <id property="id" column="tid" jdbcType="VARCHAR"/>
        <result property="name" column="tname" jdbcType="VARCHAR"/>
        <result property="sex" column="tsex" jdbcType="VARCHAR"/>
        <result property="age" column="tage" jdbcType="INTEGER"/>
        <result property="birthday" column="tbirthday" jdbcType="DATE"/>
        <result property="phone" column="tphone" jdbcType="VARCHAR"/>
        <result property="eMail" column="te_mail" jdbcType="VARCHAR"/>
        <result property="address" column="taddress" jdbcType="VARCHAR"/>
        <result property="idCard" column="tid_card" jdbcType="VARCHAR"/>
        <result property="isDelete" column="tis_delete" jdbcType="VARCHAR"/>
        <result property="createUser" column="tcreate_user" jdbcType="VARCHAR"/>
        <result property="createTime" column="tcreate_time" jdbcType="DATE"/>
        <result property="lastModifyUser" column="tlast_modify_user" jdbcType="VARCHAR"/>
        <result property="lastModifyTime" column="tlast_modify_time" jdbcType="DATE"/>
    </resultMap>

    <!-- 批量新增用户信息 -->
    <insert id="addUserInfo" parameterType="java.util.List">
        insert into user_info
        (
        tid,
        tname,
        tsex,
        tage,
        tbirthday,
        tphone,
        te_mail,
        taddress,
        tid_card,
        tis_delete,
        tcreate_user,
        tcreate_time,
        tlast_modify_user,
        tlast_modify_time
        )
        value
        <foreach collection="list" index="index" item="item" separator=",">
            (
            #{item.id},
            #{item.name},
            #{item.sex},
            #{item.age},
            #{item.birthday},
            #{item.phone},
            #{item.eMail},
            #{item.address},
            #{item.idCard},
            #{item.isDelete},
            #{item.createUser},
            #{item.createTime},
            #{item.lastModifyUser},
            #{item.lastModifyTime}
            )
        </foreach>
    </insert>

    <!-- 修改用户信息 -->
    <update id="updateUserInfo" parameterType="com.example.Icetea.entry.UserInfo">
        update user_info
        <set>
            tname = #{name},
            tsex = #{sex},
            tage = #{age},
            tbirthday = #{birthday},
            tphone = #{phone},
            te_mail = #{eMail},
            taddress = #{address},
            tid_card = #{idCard},
            tlast_modify_user = #{lastModifyUser},
            tlast_modify_time = #{lastModifyTime}
        </set>
        where tis_delete = 'N'
        <if test="id != null and id != ''">
            and tid = #{id}
        </if>
    </update>

    <!-- 批量删除用户信息 -->
    <update id="deleteUserInfo" parameterType="com.example.Icetea.dto.UserInfoDto">
        update user_info
        set tis_delete = 'Y',
            tlast_modify_user = #{lastModifyUser},
            tlast_modify_time = #{lastModifyTime}
        where tis_delete = 'N'
            and tid in
            <foreach collection="deleteIds" index="index" item="item" open="(" close=")" separator=",">
                #{item}
            </foreach>
    </update>

    <!-- 查询用户信息列表 -->
    <select id="queryUserInfoList" resultMap="UserInfoMap">
        select * from user_info
        where tis_delete = 'N'
    </select>

    <!-- 根据id查询用户信息 -->
    <select id="queryUserInfoByUserId" resultMap="UserInfoMap" parameterType="java.util.List">
        select * from user_info
        where tis_delete = 'N'
        <if test="list != null and list.size() != 0">
            and tid in
            <foreach collection="list" index="index" item="item" open="(" close=")" separator=",">
                #{item}
            </foreach>
        </if>
    </select>

</mapper>